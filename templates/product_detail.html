{% load static %}
{% load custom_filter %}
<!DOCTYPE html>
<html>
    <head>
        {# Load the tag library #}
        {% load django_bootstrap5 %}
        {% load crispy_forms_tags %}
        {# Load CSS and JavaScript #}
        {% bootstrap_css %}
        {% bootstrap_javascript %}
        {# Display django.contrib.messages as Bootstrap alerts #}
        {% bootstrap_messages %}
        {# Display a form #}
        <script src="https://unpkg.com/htmx.org@1.9.10"
                integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC"
                crossorigin="anonymous"></script>
        <link rel="stylesheet"
              type="text/css"
              href="{% static 'css/font_css/fontawesome.min.css' %}" />
        <link rel="stylesheet"
              href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
              integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer" />
        <!--Custom CSS -->
        <link rel="stylesheet"
              type="text/css"
              href="{% static '/css/product_list.css' %}" />
    </head>
    <body>
        <!-- navbar here-->
        <section>
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <a style="padding-left:41px"
                   class="navbar-brand"
                   href="{% url 'Homepage:Home' %}">E-Store</a>
                <button class="navbar-toggler"
                        type="button"
                        data-toggle="collapse"
                        data-target="#navbarSupportedContent"
                        aria-controls="navbarSupportedContent"
                        aria-expanded="false"
                        aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <div class="Home-container">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'i:MonitorListView' %}">Monitor Home</a>
                            </li>
                        </ul>
                    </div>
                    <div class="my-post-list-container">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'i:list_of_monitors_for_user' %}">Your Monitor's</a>
                            </li>
                        </ul>
                    </div>
                    <div class="blog-post-create-container">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'i:select_product_category' %}">Create Monitor</a>
                            </li>
                        </ul>
                    </div>
                    <div class="form-class" style="margin-left:550px;">
                        <form class="form-inline my-2 my-lg-0"
                              style="display:flex"
                              hx-get="#"
                              hx-target="#htmx-container">
                            <div>
                                <input style="width:300px"
                                       class="form-control mr-sm-2"
                                       type="search"
                                       placeholder="Search"
                                       aria-label="Search"
                                       name="search"
                                       hx-get="#"
                                       hx-trigger="keyup changed delay:100ms"
                                       hx-target="#htmx-container">
                            </div>
                            <div style="margin-left:11px;">
                                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
                            </div>
                        </form>
                    </div>
                </div>
            </nav>
        </section>
        <!-- product images and details here-->
        <section>
            <div class="container">
                <div class="row">
                    <div class="col-lg-6">
                        <!-- Product Image -->
                        <div class="product-card">
                            <div class="col-3">
                                <div class="row-3">
                                    <div class="img-wrapper">
                                        <div class="image-container">
                                            {% if not monitor.image_2 %}
                                                <img class="card-img-top"
                                                     src="{{ monitor.image_2 }}"
                                                     alt="Product Image 2">
                                            {% else %}
                                                <img class="card-img-top"
                                                     src="{% static '/images/shoe_right.jpg' %}"
                                                     alt="Product Image 2">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="row-3">
                                    <div class="img-wrapper">
                                        <div class="two-image-container">
                                            <div class="image-left">
                                                {% if not monitor.image_1 %}
                                                    <img class="card-img-top"
                                                         src="{{ monitor.image_1 }}"
                                                         alt="Product Image 1">
                                                {% else %}
                                                    <img class="card-img-top"
                                                         src="{% static '/images/shoe_bottom.jpg' %}"
                                                         alt="Product Image 1">
                                                {% endif %}
                                            </div>
                                            <div class="image-right">
                                                {% if not monitor.image_3 %}
                                                    <img class="card-img-top"
                                                         src="{{ monitor.image_3 }}"
                                                         alt="Product Image 3">
                                                {% else %}
                                                    <img class="card-img-top"
                                                         src="{% static '/images/shoes_top.jpg' %}"
                                                         alt="Product Image 3">
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Product image end -->
                    </div>
                    <!-- Product Details -->
                    <div class="col-lg-6">
                        <div class="product-card">
                            <div class="product-details">
                                <h3>{{ monitor }}</h3>
                                <p>
                                    <b>Price:</b> ${{ monitor.price }}
                                </p>
                                <p>
                                    <b>Mounting Type:</b> {{ monitor.mounting_type }}
                                </p>
                                <p>
                                    <b>Brand:</b> {{ monitor.brand }}
                                </p>
                                <p>
                                    <b>Aspect Ratio:</b> {{ monitor.aspect_ratio }}
                                </p>
                                <p>
                                    <b>Max Display Resolution:</b> {{ monitor.max_display_resolution }} Pixels
                                </p>
                                <p>
                                    <b>Screen Size:</b> {{ monitor.screen_size }}
                                </p>
                                <p>
                                    <b>Monitor Type:</b> {{ monitor.monitor_type }}
                                </p>
                                <p>
                                    <b>Refresh Rate:</b> {{ monitor.refresh_rate }} Hz
                                </p>
                                <p>
                                    <b>Item Dimensions:</b> {{ monitor.item_dimensions }} inches
                                </p>
                                <p>
                                    <b>Item Weight:</b> {{ monitor.item_weight }} lb.
                                </p>
                                <p>
                                    <b>Voltage:</b> {{ monitor.voltage }} V
                                </p>
                                <p>
                                    <b>Color:</b> {{ monitor.color }}
                                </p>
                                <p>
                                    <b>HDMI Port:</b> {{ monitor.hdmi_port }}
                                </p>
                                <p>
                                    <b>Built-in Speakers:</b> {{ monitor.built_speakers }}
                                </p>
                                <p>
                                    <b>Quantity Available:</b> {{ monitor.quantity_available }}
                                </p>
                                <!-- Add more attributes here as needed -->
                                <p>
                                    <b>Special Features:</b>
                                    {% for feature in sp %}
                                        {{ feature }}
                                        {% if not forloop.last %},{% endif %}
                                    {% endfor %}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- User scorecard and progess bar here -->
        <section style="margin-top: 101px;
                        margin-bottom:91px;
                        width:550px;
                        margin-left:300px">
            <!-- star rating stars here-->
            <div class="average-rating">
                {% if rating == 0 or rating == "N/A" %}
                    <i data-star="0"></i>
                {% else %}
                    <i data-star="{{ average_rating }}"></i>
                {% endif %}
            </div>
            <p>{{ average_rating }} average based on {{ total_ratings }} reviews.</p>
            <hr style="border:3px solid #f1f1f1">
            <!-- progress bar here-->
            <div class="row">
                {% for rating, count in star_ratings.items %}
                    <div class="side">
                        <div>{{ rating }} star</div>
                    </div>
                    <div class="middle">
                        <div class="bar-container">
                            <div class="bar-{{ rating }}"
                                 style="width: {{ width_percentages|get_value_from_dict:rating }}%"></div>
                        </div>
                    </div>
                    <div class="side right">
                        <div>{{ count }}</div>
                    </div>
                {% endfor %}
            </div>
        </section>
        <!--- your browsing history here -->
        {% if zipped %}
            <section style="margin-bottom: 101px; margin-left:101px;">
                <div>
                    <div style="margin-top: 21px;">
                        <h4>Your Browsing History</h4>
                    </div>
                    <div style="display: flex;">
                        <div class="col-md-10">
                            <div class="card-container" style="margin-top: 21px; display:flex;">
                                {% for items in zipped %}
                                    {% with item=items %}
                                        <div class="col mb-4">
                                            <div class="card" style="width: 175px; height:450px;">
                                                <div class="image-container" style="height: 100px; width: 100px;">
                                                    <img class="card-img-top" src="{{ item.3 }}" alt="Card image cap">
                                                </div>
                                                <div class="card-body">
                                                    <div>
                                                        <h5 class="card-title">Name: {{ item.0 }}</h5>
                                                        <p class="card-text">
                                                            <b>Price</b>: {{ item.1 }}
                                                        </p>
                                                        {% if item.5.0 != 1 and item.5.1 != 1 %}
                                                            <p class="card-text">
                                                                <b>Features</b>: {{ item.5.0 }}, {{ item.5.1 }}
                                                            </p>
                                                        {% endif %}
                                                    </div>
                                                    <div class="average-rating">
                                                        {% if item.2 == 0 %}
                                                            <i data-star="0"></i>
                                                        {% else %}
                                                            <i data-star="{{ item.2 }}"></i>
                                                        {% endif %}
                                                    </div>
                                                    <a href="{{ item.4 }}" class="stretched-link">View</a>
                                                </div>
                                            </div>
                                        </div>
                                    {% endwith %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        {% endif %}
        <!--user comments here -->
        <section style="background-color: #ad655f;">
            <div style="margin-left: 51px;">
                <strong><span><a class="btn btn-info"
   style="width: 1250px;
          height:51px;
          font-size:31px"
   href="{% url 'i:monitor_add_review' product_id=monitor.monitor_id %}">Add A Review</a></span></strong>
            </div>
            <div class="container my-5 py-5">
                <div class="row d-flex justify-content-center">
                    <div class="col-md-12 col-lg-10">
                        <div class="card text-dark">
                            {% if comments %}
                                <div class="card-body p-4">
                                    <h4 class="mb-0" style="padding-bottom: 41px;">Recent comments</h4>
                                    {% for comment in comments %}
                                        <div class="d-flex flex-start">
                                            <div style="display: flex;">
                                                <img class="rounded-circle shadow-1-strong me-3"
                                                     src="{{ comment.image_1 }}"
                                                     alt="avatar"
                                                     width="150"
                                                     height="150" />
                                                <img class="rounded-circle shadow-1-strong me-3"
                                                     src="{{ comment.image_2 }}"
                                                     alt="avatar"
                                                     width="150"
                                                     height="150" />
                                            </div>
                                            <div>
                                                <h6 class="fw-bold mb-1">User: {{ comment.user.username }}</h6>
                                                <div class="d-flex align-items-center mb-3">
                                                    <p class="mb-0 text-muted">
                                                        created: {{ comment.created_at }}
                                                        {% if comment.status %}
                                                            <span class="badge bg-primary">Active</span>
                                                        {% else %}
                                                            <span class="badge bg-primary">Pending</span>
                                                        {% endif %}
                                                    </p>
                                                    <a href="{% url 'i:monitor_update_review' product_id=monitor.monitor_id review_id=comment.id %}"
                                                       class="link-muted"
                                                       style="padding-right: 5px"><i class="fa-solid fa-pencil ms-2"></i></a>
                                                    <!-- Button trigger modal -->
                                                    <a class="link-muted"
                                                       data-bs-toggle="modal"
                                                       data-bs-target="#exampleModal{{ comment.id }}">
                                                        <i class="fa-solid fa-trash"></i>
                                                    </a>
                                                    <!-- Modal -->
                                                    <div class="modal fade"
                                                         id="exampleModal{{ comment.id }}"
                                                         tabindex="-1"
                                                         role="dialog"
                                                         aria-labelledby="exampleModalLabel{{ comment.id }}"
                                                         aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLabel{{ comment.id }}">Confirmation Required</h5>
                                                                    <button type="button"
                                                                            class="close"
                                                                            data-bs-dismiss="modal"
                                                                            aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <!-- Confirmation message -->
                                                                    <p>Are you sure you want to delete this comment?</p>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                                                                    <a href="{% url 'i:monitor_delete_review' product_id=monitor.monitor_id review_id=comment.id %}"
                                                                       class="btn btn-primary">Delete Comment</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p class="mb-0">{{ comment.text }}</p>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% else %}
                            <strong><span style="font-size: 25px;">No Comments Posted Yet!</span></strong>
                        {% endif %}
                    </div>
                </div>
            </div>
        </section>
    </body>
</html>
